{"version":3,"file":"draggable.js","sourceRoot":"","sources":["../../../../../../../projects/angular2gridster/src/lib/utils/draggable.ts"],"names":[],"mappings":"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","sourcesContent":["import { Observable, fromEvent, merge, pipe } from 'rxjs';\r\nimport { share, map, filter, tap, switchMap, takeUntil, take, skip } from 'rxjs/operators';\r\n\r\nimport { DraggableEvent } from './DraggableEvent';\r\nimport { utils } from './utils';\r\n\r\nexport class Draggable {\r\n    static SCROLL_SPEED = 20;\r\n    element: Element;\r\n\r\n    dragStart: Observable<DraggableEvent>;\r\n    dragMove: Observable<DraggableEvent>;\r\n    dragStop: Observable<DraggableEvent>;\r\n    // A simple requestAnimationFrame polyfill\r\n    private requestAnimationFrame: Function;\r\n    private cancelAnimationFrame: Function;\r\n    private mousemove: Observable<{} | Event> = merge(\r\n        fromEvent(document, 'mousemove'),\r\n        fromEvent(document, 'touchmove', { passive: false })\r\n    ).pipe(share());\r\n    private mouseup: Observable<{} | Event> = merge(\r\n        fromEvent(document, 'mouseup'),\r\n        fromEvent(document, 'touchend'),\r\n        fromEvent(document, 'touchcancel')\r\n    ).pipe(share());\r\n    private mousedown: Observable<{} | Event>;\r\n    private config = {\r\n        handlerClass: <any>null,\r\n        scroll: true,\r\n        scrollEdge: 36,\r\n        scrollDirection: <any>null\r\n    };\r\n    // reference to auto scrolling listeners\r\n    private autoScrollingInterval: Function[] = [];\r\n\r\n    constructor(element: Element, config = {}) {\r\n        this.element = element;\r\n        this.mousedown = merge(\r\n            fromEvent(element, 'mousedown'),\r\n            fromEvent(element, 'touchstart')\r\n        ).pipe(share());\r\n\r\n        this.config = { ...this.config, ...config };\r\n\r\n        this.dragStart = this.createDragStartObservable().pipe(share());\r\n        this.dragMove = this.createDragMoveObservable(this.dragStart);\r\n        this.dragStop = this.createDragStopObservable(this.dragStart);\r\n\r\n        this.fixProblemWithDnDForIE(element);\r\n\r\n        this.requestAnimationFrame = window.requestAnimationFrame || ((callback: FrameRequestCallback) => setTimeout(callback, 1000 / 60));\r\n        this.cancelAnimationFrame = window.cancelAnimationFrame || ((cafID: number) => clearTimeout(cafID));\r\n    }\r\n\r\n    private createDragStartObservable(): Observable<DraggableEvent> {\r\n        return this.mousedown.pipe(\r\n            map(md => new DraggableEvent(md)),\r\n            filter((event: DraggableEvent) => this.isDragingByHandler(event)),\r\n            tap((e: DraggableEvent) => {\r\n                if (!e.isTouchEvent()) {\r\n                    e.pauseEvent();\r\n                }\r\n                if (document.activeElement) {\r\n                    (<any>document.activeElement).blur();\r\n                }\r\n                // prevents rendering performance issues while dragging item with selection inside\r\n                utils.clearSelection();\r\n            }),\r\n            switchMap((startEvent: DraggableEvent) => {\r\n                return this.mousemove.pipe(\r\n                    map(mm => new DraggableEvent(mm)),\r\n                    filter((moveEvent: DraggableEvent) => this.inRange(startEvent, moveEvent, 5)),\r\n                    map(() => startEvent),\r\n                    takeUntil(this.mouseup),\r\n                    take(1)\r\n                );\r\n            })\r\n        );\r\n    }\r\n\r\n    private createDragMoveObservable(\r\n        dragStart: Observable<DraggableEvent>\r\n    ): Observable<DraggableEvent> {\r\n        return dragStart.pipe(\r\n            tap((event: DraggableEvent) => {\r\n                this.addTouchActionNone(event.target);\r\n            }),\r\n            switchMap((startEvent: DraggableEvent) => {\r\n                return this.mousemove.pipe(\r\n                    skip(1),\r\n                    map(mm => new DraggableEvent(mm)),\r\n                    tap((event: DraggableEvent) => {\r\n                        event.pauseEvent();\r\n                        startEvent.pauseEvent();\r\n                    }),\r\n                    takeUntil(this.mouseup)\r\n                );\r\n            }),\r\n            filter(val => !!val),\r\n            tap((event: DraggableEvent) => {\r\n                if (this.config.scroll) {\r\n                    this.startScroll(this.element, event);\r\n                }\r\n            })\r\n        );\r\n    }\r\n\r\n    private createDragStopObservable(dragStart: Observable<DraggableEvent>): Observable<any> {\r\n        return dragStart.pipe(\r\n            switchMap(() => {\r\n                return this.mouseup.pipe(take(1));\r\n            }),\r\n            map(e => new DraggableEvent(e)),\r\n            tap((e: DraggableEvent) => {\r\n                if (e.target) {\r\n                    this.removeTouchActionNone(e.target);\r\n                }\r\n                this.autoScrollingInterval.forEach(raf => this.cancelAnimationFrame(raf));\r\n            })\r\n        );\r\n    }\r\n\r\n    private startScroll(item: Element, event: DraggableEvent) {\r\n        const scrollContainer = this.getScrollContainer(item);\r\n        this.autoScrollingInterval.forEach(raf => this.cancelAnimationFrame(raf));\r\n\r\n        if (scrollContainer) {\r\n            this.startScrollForContainer(event, scrollContainer);\r\n        } else {\r\n            this.startScrollForWindow(event);\r\n        }\r\n    }\r\n\r\n    private startScrollForContainer(event: DraggableEvent, scrollContainer: HTMLElement): void {\r\n        if (!this.config.scrollDirection || this.config.scrollDirection === 'vertical') {\r\n            this.startScrollVerticallyForContainer(event, scrollContainer);\r\n        }\r\n\r\n        if (!this.config.scrollDirection || this.config.scrollDirection === 'horizontal') {\r\n            this.startScrollHorizontallyForContainer(event, scrollContainer);\r\n        }\r\n    }\r\n\r\n    private startScrollVerticallyForContainer(\r\n        event: DraggableEvent,\r\n        scrollContainer: HTMLElement\r\n    ): void {\r\n        if (event.pageY - this.getOffset(scrollContainer).top < this.config.scrollEdge) {\r\n            this.startAutoScrolling(scrollContainer, -Draggable.SCROLL_SPEED, 'scrollTop');\r\n        } else if (\r\n            this.getOffset(scrollContainer).top +\r\n                scrollContainer.getBoundingClientRect().height -\r\n                event.pageY <\r\n            this.config.scrollEdge\r\n        ) {\r\n            this.startAutoScrolling(scrollContainer, Draggable.SCROLL_SPEED, 'scrollTop');\r\n        }\r\n    }\r\n\r\n    private startScrollHorizontallyForContainer(\r\n        event: DraggableEvent,\r\n        scrollContainer: HTMLElement\r\n    ): void {\r\n        if (event.pageX - scrollContainer.getBoundingClientRect().left < this.config.scrollEdge) {\r\n            this.startAutoScrolling(scrollContainer, -Draggable.SCROLL_SPEED, 'scrollLeft');\r\n        } else if (\r\n            this.getOffset(scrollContainer).left +\r\n                scrollContainer.getBoundingClientRect().width -\r\n                event.pageX <\r\n            this.config.scrollEdge\r\n        ) {\r\n            this.startAutoScrolling(scrollContainer, Draggable.SCROLL_SPEED, 'scrollLeft');\r\n        }\r\n    }\r\n\r\n    private startScrollForWindow(event: DraggableEvent) {\r\n\r\n        if (!this.config.scrollDirection || this.config.scrollDirection === 'vertical') {\r\n            this.startScrollVerticallyForWindow(event);\r\n        }\r\n\r\n        if (!this.config.scrollDirection || this.config.scrollDirection === 'horizontal') {\r\n            this.startScrollHorizontallyForWindow(event);\r\n        }\r\n    }\r\n\r\n    private startScrollVerticallyForWindow(event: DraggableEvent): void {\r\n        const scrollingElement =\r\n            document.scrollingElement || document.documentElement || document.body;\r\n\r\n        // NOTE: Using `window.pageYOffset` here because IE doesn't have `window.scrollY`.\r\n        if (event.pageY - window.pageYOffset < this.config.scrollEdge) {\r\n            this.startAutoScrolling(scrollingElement, -Draggable.SCROLL_SPEED, 'scrollTop');\r\n        } else if (\r\n            window.innerHeight - (event.pageY - window.pageYOffset) <\r\n            this.config.scrollEdge\r\n        ) {\r\n            this.startAutoScrolling(scrollingElement, Draggable.SCROLL_SPEED, 'scrollTop');\r\n        }\r\n    }\r\n\r\n    private startScrollHorizontallyForWindow(event: DraggableEvent): void {\r\n        const scrollingElement =\r\n            document.scrollingElement || document.documentElement || document.body;\r\n\r\n        // NOTE: Using `window.pageXOffset` here because IE doesn't have `window.scrollX`.\r\n        if (event.pageX - window.pageXOffset < this.config.scrollEdge) {\r\n            this.startAutoScrolling(scrollingElement, -Draggable.SCROLL_SPEED, 'scrollLeft');\r\n        } else if (\r\n            window.innerWidth - (event.pageX - window.pageXOffset) <\r\n            this.config.scrollEdge\r\n        ) {\r\n            this.startAutoScrolling(scrollingElement, Draggable.SCROLL_SPEED, 'scrollLeft');\r\n        }\r\n    }\r\n\r\n    private getScrollContainer(node: any): HTMLElement {\r\n        const nodeOuterHeight = utils.getElementOuterHeight(node);\r\n\r\n        if (node.scrollHeight > Math.ceil(nodeOuterHeight)) {\r\n            return node;\r\n        }\r\n\r\n        if (!new RegExp('(body|html)', 'i').test(node.parentNode.tagName)) {\r\n            return this.getScrollContainer(node.parentNode);\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    private startAutoScrolling(node: any, amount: number, direction: any) {\r\n        this.autoScrollingInterval.push(this.requestAnimationFrame(function() {\r\n            this.startAutoScrolling(node, amount, direction);\r\n        }.bind(this)));\r\n\r\n        return (node[direction] += amount * 0.25);\r\n    }\r\n\r\n    private getOffset(el: HTMLElement) {\r\n        const rect = el.getBoundingClientRect();\r\n        return {\r\n            left: rect.left + this.getScroll('scrollLeft', 'pageXOffset'),\r\n            top: rect.top + this.getScroll('scrollTop', 'pageYOffset')\r\n        };\r\n    }\r\n\r\n    private getScroll(scrollProp: keyof HTMLElement, offsetProp: keyof Window) {\r\n        if (typeof window[offsetProp] !== 'undefined') {\r\n            return window[offsetProp];\r\n        }\r\n        if (document.documentElement.clientHeight) {\r\n            return document.documentElement[scrollProp];\r\n        }\r\n        return document.body[scrollProp];\r\n    }\r\n\r\n    private isDragingByHandler(event: DraggableEvent): boolean {\r\n        if (!this.isValidDragHandler(event.target)) {\r\n            return false;\r\n        }\r\n\r\n        return (\r\n            !this.config.handlerClass ||\r\n            (this.config.handlerClass &&\r\n                this.hasElementWithClass(this.config.handlerClass, event.target))\r\n        );\r\n    }\r\n\r\n    private isValidDragHandler(targetEl: any): boolean {\r\n        return ['input', 'textarea'].indexOf(targetEl.tagName.toLowerCase()) === -1;\r\n    }\r\n\r\n    private inRange(startEvent: DraggableEvent, moveEvent: DraggableEvent, range: number): boolean {\r\n        return (\r\n            Math.abs(moveEvent.clientX - startEvent.clientX) > range ||\r\n            Math.abs(moveEvent.clientY - startEvent.clientY) > range\r\n        );\r\n    }\r\n\r\n    private hasElementWithClass(className: string, target: any): boolean {\r\n        while (target !== this.element) {\r\n            if (target.classList.contains(className)) {\r\n                return true;\r\n            }\r\n            target = target.parentElement;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    public pauseEvent(e: Event): void {\r\n        if (e.stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n        if (e.preventDefault) {\r\n            e.preventDefault();\r\n        }\r\n        e.cancelBubble = true;\r\n        e.returnValue = false;\r\n    }\r\n\r\n    private fixProblemWithDnDForIE(element: Element) {\r\n        if (this.isTouchDevice() && this.isIEorEdge() && (<HTMLElement>element).style) {\r\n            (<any>(<HTMLElement>element).style)['touch-action'] = 'none';\r\n        }\r\n    }\r\n\r\n    private removeTouchActionNone(element: Element) {\r\n        if (!(<HTMLElement>element).style) {\r\n            return;\r\n        }\r\n        (<any>(<HTMLElement>element).style)['touch-action'] = '';\r\n    }\r\n\r\n    private addTouchActionNone(element) {\r\n        if (!(<HTMLElement>element).style) {\r\n            return;\r\n        }\r\n        (<any>(<HTMLElement>element).style)['touch-action'] = 'none';\r\n    }\r\n\r\n    private isTouchDevice() {\r\n        return (\r\n            'ontouchstart' in window || navigator.maxTouchPoints // works on most browsers\r\n        ); // works on IE10/11 and Surface\r\n    }\r\n\r\n    private isIEorEdge() {\r\n        const ua = window.navigator.userAgent;\r\n\r\n        const msie = ua.indexOf('MSIE ');\r\n        if (msie > 0) {\r\n            // IE 10 or older => return version number\r\n            return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\r\n        }\r\n\r\n        const trident = ua.indexOf('Trident/');\r\n        if (trident > 0) {\r\n            // IE 11 => return version number\r\n            const rv = ua.indexOf('rv:');\r\n            return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\r\n        }\r\n\r\n        const edge = ua.indexOf('Edge/');\r\n        if (edge > 0) {\r\n            // Edge (IE 12+) => return version number\r\n            return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\r\n        }\r\n\r\n        // other browser\r\n        return false;\r\n    }\r\n}\r\n"]}